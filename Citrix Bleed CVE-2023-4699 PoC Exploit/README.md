# Citrix Bleed CVE-2023-4966 PoC Exploit
CISA released an advisory on the LockBit ransowmare group adopting Citrix Bleed CVE-2023-4966 vulnerability.<br><br>
In this repo, Picus provides Proof-of-Concept exploit for the Citrix Bleed CVE-2023-4966 vulnerability.

Test security controls against the CVE-2023-4966 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2023-4966 vulnerability exploits for free. No setup or signup required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information check out our blog post: [CVE-2023-4966: LockBit Exploits Citrix Bleed in Ransomware Attacks](https://www.picussecurity.com/resource/blog/cve-2023-4966-lockbit-exploits-citrix-bleed-in-ransomware-attacks)


CVE-2023-4966 Proof-of-concept (POC)
----------------------
NetScaler ADC and Gateway products use the NetScaler Packet Processing Engine (nsppe) to handle TCP/IP connections and HTTP services. <br>
In vulnerable NetScaler ADC and Gateway products, the nsspe binary that implements the OpenID Connect Discovery endpoint is vulnerable to buffer overflow attacks. If adversaries send a maliciously crafted HTTP request to this endpoint with a too-long Host header, the vulnerable endpoint returns the leaked memory in the response. When too much memory is leaked, adversaries can read a valid session cookie of a legitimate user and bypass authentication.<br>

The example HTTP GET request below exploits CVE-2023-4966 vulnerability to read a valid session cookie and bypass authentication.

#### Example CVE-2024-27199 Exploit:
```http
GET /oauth/idp/.well-known/openid-configuration HTTP/1.1
Host: a ...<too_many>...a
Connection: close
```

Disclaimer
----------
We do not have any disclamer.
